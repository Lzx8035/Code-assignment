<div class="filters-panel">
  <!-- Row 1: Fund Name, Currency, Fund Size, Vintage Year -->
  <div class="filters-row">
    <div class="filter-group">
      <label>Fund Name</label>
      <input
        type="text"
        [(ngModel)]="filters.name"
        placeholder="Search by name..."
        class="form-input"
      />
    </div>

    <div class="filter-group">
      <label>Currency</label>
      <app-custom-dropdown
        [options]="getCurrencyOptions()"
        [selectedValues]="filters.currency ? [filters.currency] : []"
        [placeholder]="'All Currencies'"
        [multiple]="false"
        [active]="!!filters.currency"
        [isOpen]="showCurrencyDropdown"
        (selectionChange)="onCurrencyChange($event)"
        (isOpenChange)="showCurrencyDropdown = $event"
      ></app-custom-dropdown>
    </div>

    <div class="filter-group">
      <label>Fund Size</label>
      <div class="range-inputs">
        <input
          type="number"
          [(ngModel)]="filters.minFundSize"
          placeholder="Min"
          class="form-input"
          min="0"
          step="0.01"
        />
        <span class="range-separator">-</span>
        <input
          type="number"
          [(ngModel)]="filters.maxFundSize"
          placeholder="Max"
          class="form-input"
          min="0"
          step="0.01"
        />
      </div>
    </div>

    <div class="filter-group">
      <label>Vintage Year</label>
      <div class="range-inputs">
        <input
          type="number"
          [(ngModel)]="filters.minVintage"
          placeholder="Min Year"
          class="form-input"
          min="0"
        />
        <span class="range-separator">-</span>
        <input
          type="number"
          [(ngModel)]="filters.maxVintage"
          placeholder="Max Year"
          class="form-input"
          min="0"
        />
      </div>
    </div>
  </div>

  <!-- Row 2: Strategies, Geographies, Managers, Sort By -->
  <div class="filters-row">
    <div class="filter-group">
      <label>Strategies</label>
      <app-custom-dropdown
        [options]="getStrategyOptions()"
        [selectedValues]="filters.strategies"
        [placeholder]="'Select Strategies'"
        [multiple]="true"
        [active]="filters.strategies.length > 0"
        [isOpen]="showStrategiesDropdown"
        (selectionChange)="onStrategiesChange($event)"
        (isOpenChange)="showStrategiesDropdown = $event"
      ></app-custom-dropdown>
    </div>

    <div class="filter-group">
      <label>Geographies</label>
      <app-custom-dropdown
        [options]="getGeographyOptions()"
        [selectedValues]="filters.geographies"
        [placeholder]="'Select Geographies'"
        [multiple]="true"
        [active]="filters.geographies.length > 0"
        [isOpen]="showGeographiesDropdown"
        (selectionChange)="onGeographiesChange($event)"
        (isOpenChange)="showGeographiesDropdown = $event"
      ></app-custom-dropdown>
    </div>

    <div class="filter-group">
      <label>Managers</label>
      <app-custom-dropdown
        [options]="getManagerOptions()"
        [selectedValues]="filters.managers"
        [placeholder]="'Select Managers'"
        [multiple]="true"
        [active]="filters.managers.length > 0"
        [isOpen]="showManagersDropdown"
        (selectionChange)="onManagersChange($event)"
        (isOpenChange)="showManagersDropdown = $event"
      ></app-custom-dropdown>
    </div>

    <div class="filter-group">
      <label>Sort By</label>
      <app-custom-dropdown
        [options]="getSortByOptions()"
        [selectedValues]="getCurrentSortValue()"
        [placeholder]="'No Sorting'"
        [multiple]="false"
        [active]="!!filters.sortBy"
        [isOpen]="showSortByDropdown"
        (selectionChange)="onSortByChange($event)"
        (isOpenChange)="showSortByDropdown = $event"
      ></app-custom-dropdown>
    </div>
  </div>

  <div class="filters-header">
    <div
      class="selected-filters"
      *ngIf="
        filters.strategies.length > 0 ||
        filters.geographies.length > 0 ||
        filters.managers.length > 0
      "
    >
      <span class="selected-label">Active Filters:</span>
      <app-tag
        *ngFor="let strategy of filters.strategies"
        [text]="strategy"
        type="strategy"
        [closable]="true"
        (close)="toggleStrategy(strategy)"
      ></app-tag>
      <app-tag
        *ngFor="let geography of filters.geographies"
        [text]="geography"
        type="geography"
        [closable]="true"
        (close)="toggleGeography(geography)"
      ></app-tag>
      <app-tag
        *ngFor="let manager of filters.managers"
        [text]="manager"
        type="manager"
        [closable]="true"
        (close)="toggleManager(manager)"
      ></app-tag>
    </div>

    <div class="header-actions">
      <button
        class="btn btn-secondary"
        (click)="onReset()"
        [disabled]="loading"
      >
        Reset
      </button>
      <button class="btn btn-primary" (click)="onSearch()" [disabled]="loading">
        <span *ngIf="!loading">Search</span>
        <span *ngIf="loading" class="loading-spinner"></span>
      </button>
    </div>
  </div>
</div>
