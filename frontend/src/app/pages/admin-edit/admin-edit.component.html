<div class="admin-edit-container">
  <header class="header">
    <button class="btn btn-back" (click)="goBack()">
      <app-icon name="arrow-left" [size]="16"></app-icon>
      Back to Funds List
    </button>
    <h1>Edit Fund</h1>
  </header>

  <div *ngIf="loading" class="loading">
    <p>Loading fund data...</p>
  </div>

  <div *ngIf="error && !loading" class="error-message">
    <p>{{ error }}</p>
    <button class="btn btn-primary" (click)="goBack()">Go Back</button>
  </div>

  <div *ngIf="!loading && fund" class="edit-form">
    <div class="form-header">
      <h2>{{ fund.name }}</h2>
      <div class="status-indicators">
        <span *ngIf="saving" class="status-saving">Saving...</span>
        <span *ngIf="success" class="status-success">{{ success }}</span>
        <span *ngIf="error" class="status-error">{{ error }}</span>
      </div>
    </div>

    <form class="fund-form">
      <!-- Basic Information -->
      <div class="form-section">
        <h3>Basic Information</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="name">Fund Name</label>
            <input
              type="text"
              id="name"
              [(ngModel)]="fund.name"
              (ngModelChange)="onFieldChange()"
              name="name"
              class="form-input"
              required
            />
          </div>

          <div class="form-group">
            <label for="currency">Currency</label>
            <select
              id="currency"
              [(ngModel)]="fund.currency"
              (ngModelChange)="onFieldChange()"
              name="currency"
              class="form-select"
              required
            >
              <option value="">Select Currency</option>
              <option
                *ngFor="let currency of filterMeta.currencies"
                [value]="currency"
              >
                {{ currency }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="fundSize">Fund Size</label>
            <input
              type="number"
              id="fundSize"
              [(ngModel)]="fund.fundSize"
              (ngModelChange)="onFieldChange()"
              name="fundSize"
              class="form-input"
              step="0.01"
              required
            />
          </div>

          <div class="form-group">
            <label for="vintage">Vintage Year</label>
            <input
              type="number"
              id="vintage"
              [(ngModel)]="fund.vintage"
              (ngModelChange)="onFieldChange()"
              name="vintage"
              class="form-input"
              required
            />
          </div>
        </div>
      </div>

      <!-- Strategies -->
      <div class="form-section">
        <h3>Strategies</h3>
        <div class="tag-section">
          <div class="tags-container" *ngIf="fund.strategies.length > 0">
            <app-tag
              *ngFor="let strategy of fund.strategies; let i = index"
              [text]="strategy"
              type="strategy"
              [closable]="true"
              (close)="removeStrategy(i)"
            ></app-tag>
          </div>
          <div class="tag-dropdown-container">
            <select
              id="strategy-dropdown"
              (change)="addStrategyFromDropdown($event)"
              class="form-select tag-dropdown"
            >
              <option value="">Select a strategy to add</option>
              <option
                *ngFor="let option of getAvailableStrategies()"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <!-- Geographies -->
      <div class="form-section">
        <h3>Geographies</h3>
        <div class="tag-section">
          <div class="tags-container" *ngIf="fund.geographies.length > 0">
            <app-tag
              *ngFor="let geography of fund.geographies; let i = index"
              [text]="geography"
              type="geography"
              [closable]="true"
              (close)="removeGeography(i)"
            ></app-tag>
          </div>
          <div class="tag-dropdown-container">
            <select
              id="geography-dropdown"
              (change)="addGeographyFromDropdown($event)"
              class="form-select tag-dropdown"
            >
              <option value="">Select a geography to add</option>
              <option
                *ngFor="let option of getAvailableGeographies()"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <!-- Managers -->
      <div class="form-section">
        <h3>Managers</h3>
        <div class="tag-section">
          <div class="tags-container" *ngIf="fund.managers.length > 0">
            <app-tag
              *ngFor="let manager of fund.managers; let i = index"
              [text]="manager"
              type="manager"
              [closable]="true"
              (close)="removeManager(i)"
            ></app-tag>
          </div>
          <div class="tag-dropdown-container">
            <select
              id="manager-dropdown"
              (change)="addManagerFromDropdown($event)"
              class="form-select tag-dropdown"
            >
              <option value="">Select a manager to add</option>
              <option
                *ngFor="let option of getAvailableManagers()"
                [value]="option"
              >
                {{ option }}
              </option>
            </select>
          </div>
        </div>
      </div>

      <!-- Description -->
      <div class="form-section">
        <h3>Description</h3>
        <div class="form-group">
          <textarea
            id="description"
            [(ngModel)]="fund.description"
            (ngModelChange)="onFieldChange()"
            name="description"
            class="form-textarea"
            rows="4"
            placeholder="Enter fund description"
          ></textarea>
        </div>
      </div>
    </form>
  </div>
</div>
